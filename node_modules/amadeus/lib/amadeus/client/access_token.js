"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;
var _events = _interopRequireDefault(require("events"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }
function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return _typeof(key) === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (_typeof(input) !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (_typeof(res) !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
// The number of seconds before the token expires, when
// we will already try to refresh it
var TOKEN_BUFFER = 10;

/**
  * A helper library to create and maintain the OAuth2 AccessTokens between
  * requests. Keeps track of the expiry time and automatically tries to fetch
  * a new token if needed.
  *
  * @property {string} accessToken the cached current access token (bearer)
  * @property {number} expiresAt the aproximate time this token expires at
  * @protected
  */
var AccessToken = /*#__PURE__*/function () {
  function AccessToken() {
    _classCallCheck(this, AccessToken);
    this.accessToken;
    this.expiresAt;
  }

  // PROTECTED

  /**
   * Fetches or returns a cached bearer token. Used by the Client to get a
   * token before making an API call.
   *
   * @param  {Client} client the Amadeus Client to make an API call with
   * @return {Promise.<Response,ResponseError>} a Bluebird Promise
   * @protected
   */
  _createClass(AccessToken, [{
    key: "bearerToken",
    value: function bearerToken(client) {
      var emitter = new _events["default"]();
      var promise = this.promise(emitter);
      this.emitOrLoadAccessToken(client, emitter);
      return promise;
    }

    // PRIVATE

    /**
     * Builds a Bluebird promise to be returned to the API user
     *
     * @param  {type} emitter the EventEmitter used to notify the Promise of
     * @return {Promise} a Bluebird promise
     * @private
     */
  }, {
    key: "promise",
    value: function promise(emitter) {
      return new Promise(function (resolve, reject) {
        emitter.on('resolve', function (response) {
          return resolve(response);
        });
        emitter.on('reject', function (error) {
          return reject(error);
        });
      });
    }

    /**
     * Checks if the token needs a refresh, if not emits the cached token,
     * otherwise tries to load a new access token
     *
     * @param  {Client} client the Amadeus Client to make an API call with
     * @param  {type} emitter the EventEmitter used to emit the token
     * @private
     */
  }, {
    key: "emitOrLoadAccessToken",
    value: function emitOrLoadAccessToken(client, emitter) {
      if (this.needsLoadOrRefresh()) {
        this.loadAccessToken(client, emitter);
      } else {
        emitter.emit('resolve', this.accessToken);
      }
    }

    /**
     * Checks if the token needs a refresh or first load
     *
     * @return {boolean} wether the token needs a refresh
     * @private
     */
  }, {
    key: "needsLoadOrRefresh",
    value: function needsLoadOrRefresh() {
      if (!this.accessToken) {
        return true;
      } else if (Date.now() + TOKEN_BUFFER > this.expiresAt) {
        return true;
      } else {
        return false;
      }
    }

    /**
     * Loads the access token using the client, emits the token when it's loaded
     *
     * @param  {Client} client the Amadeus Client to make an API call with
     * @param  {type} emitter the EventEmitter used to emit the token
     * @private
     */
  }, {
    key: "loadAccessToken",
    value: function loadAccessToken(client, emitter) {
      var _this = this;
      client.unauthenticatedRequest('POST', '/v1/security/oauth2/token', {
        'grant_type': 'client_credentials',
        'client_id': client.clientId,
        'client_secret': client.clientSecret
      }).then(function (response) {
        _this.storeAccessToken(response);
        _this.emitOrLoadAccessToken(client, emitter);
      })["catch"](function (error) {
        emitter.emit('reject', error);
      });
    }

    /**
     * Stores a loaded access token, calculating the expiry date
     *
     * @param  {Response} response the response object received from the client
     * @private
     */
  }, {
    key: "storeAccessToken",
    value: function storeAccessToken(response) {
      this.accessToken = response.result['access_token'];
      this.expiresAt = Date.now() + response.result['expires_in'] * 1000;
    }
  }]);
  return AccessToken;
}();
var _default = AccessToken;
exports["default"] = _default;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXZlbnRzIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJvYmoiLCJfX2VzTW9kdWxlIiwiX3R5cGVvZiIsIm8iLCJTeW1ib2wiLCJpdGVyYXRvciIsImNvbnN0cnVjdG9yIiwicHJvdG90eXBlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9kZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiX3RvUHJvcGVydHlLZXkiLCJrZXkiLCJfY3JlYXRlQ2xhc3MiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJhcmciLCJfdG9QcmltaXRpdmUiLCJTdHJpbmciLCJpbnB1dCIsImhpbnQiLCJwcmltIiwidG9QcmltaXRpdmUiLCJ1bmRlZmluZWQiLCJyZXMiLCJjYWxsIiwiTnVtYmVyIiwiVE9LRU5fQlVGRkVSIiwiQWNjZXNzVG9rZW4iLCJhY2Nlc3NUb2tlbiIsImV4cGlyZXNBdCIsInZhbHVlIiwiYmVhcmVyVG9rZW4iLCJjbGllbnQiLCJlbWl0dGVyIiwiRXZlbnRFbWl0dGVyIiwicHJvbWlzZSIsImVtaXRPckxvYWRBY2Nlc3NUb2tlbiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwib24iLCJyZXNwb25zZSIsImVycm9yIiwibmVlZHNMb2FkT3JSZWZyZXNoIiwibG9hZEFjY2Vzc1Rva2VuIiwiZW1pdCIsIkRhdGUiLCJub3ciLCJfdGhpcyIsInVuYXV0aGVudGljYXRlZFJlcXVlc3QiLCJjbGllbnRJZCIsImNsaWVudFNlY3JldCIsInRoZW4iLCJzdG9yZUFjY2Vzc1Rva2VuIiwicmVzdWx0IiwiX2RlZmF1bHQiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hbWFkZXVzL2NsaWVudC9hY2Nlc3NfdG9rZW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEV2ZW50RW1pdHRlciBmcm9tICdldmVudHMnO1xuXG4vLyBUaGUgbnVtYmVyIG9mIHNlY29uZHMgYmVmb3JlIHRoZSB0b2tlbiBleHBpcmVzLCB3aGVuXG4vLyB3ZSB3aWxsIGFscmVhZHkgdHJ5IHRvIHJlZnJlc2ggaXRcbmNvbnN0IFRPS0VOX0JVRkZFUiA9IDEwO1xuXG4vKipcbiAgKiBBIGhlbHBlciBsaWJyYXJ5IHRvIGNyZWF0ZSBhbmQgbWFpbnRhaW4gdGhlIE9BdXRoMiBBY2Nlc3NUb2tlbnMgYmV0d2VlblxuICAqIHJlcXVlc3RzLiBLZWVwcyB0cmFjayBvZiB0aGUgZXhwaXJ5IHRpbWUgYW5kIGF1dG9tYXRpY2FsbHkgdHJpZXMgdG8gZmV0Y2hcbiAgKiBhIG5ldyB0b2tlbiBpZiBuZWVkZWQuXG4gICpcbiAgKiBAcHJvcGVydHkge3N0cmluZ30gYWNjZXNzVG9rZW4gdGhlIGNhY2hlZCBjdXJyZW50IGFjY2VzcyB0b2tlbiAoYmVhcmVyKVxuICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBleHBpcmVzQXQgdGhlIGFwcm94aW1hdGUgdGltZSB0aGlzIHRva2VuIGV4cGlyZXMgYXRcbiAgKiBAcHJvdGVjdGVkXG4gICovXG5jbGFzcyBBY2Nlc3NUb2tlbiB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYWNjZXNzVG9rZW47XG4gICAgdGhpcy5leHBpcmVzQXQ7XG4gIH1cblxuICAvLyBQUk9URUNURURcblxuICAvKipcbiAgICogRmV0Y2hlcyBvciByZXR1cm5zIGEgY2FjaGVkIGJlYXJlciB0b2tlbi4gVXNlZCBieSB0aGUgQ2xpZW50IHRvIGdldCBhXG4gICAqIHRva2VuIGJlZm9yZSBtYWtpbmcgYW4gQVBJIGNhbGwuXG4gICAqXG4gICAqIEBwYXJhbSAge0NsaWVudH0gY2xpZW50IHRoZSBBbWFkZXVzIENsaWVudCB0byBtYWtlIGFuIEFQSSBjYWxsIHdpdGhcbiAgICogQHJldHVybiB7UHJvbWlzZS48UmVzcG9uc2UsUmVzcG9uc2VFcnJvcj59IGEgQmx1ZWJpcmQgUHJvbWlzZVxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBiZWFyZXJUb2tlbihjbGllbnQpIHtcbiAgICBsZXQgZW1pdHRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBsZXQgcHJvbWlzZSA9IHRoaXMucHJvbWlzZShlbWl0dGVyKTtcbiAgICB0aGlzLmVtaXRPckxvYWRBY2Nlc3NUb2tlbihjbGllbnQsIGVtaXR0ZXIpO1xuICAgIHJldHVybiBwcm9taXNlO1xuICB9XG5cbiAgLy8gUFJJVkFURVxuXG4gIC8qKlxuICAgKiBCdWlsZHMgYSBCbHVlYmlyZCBwcm9taXNlIHRvIGJlIHJldHVybmVkIHRvIHRoZSBBUEkgdXNlclxuICAgKlxuICAgKiBAcGFyYW0gIHt0eXBlfSBlbWl0dGVyIHRoZSBFdmVudEVtaXR0ZXIgdXNlZCB0byBub3RpZnkgdGhlIFByb21pc2Ugb2ZcbiAgICogQHJldHVybiB7UHJvbWlzZX0gYSBCbHVlYmlyZCBwcm9taXNlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcm9taXNlKGVtaXR0ZXIpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgZW1pdHRlci5vbigncmVzb2x2ZScsIHJlc3BvbnNlID0+IHJlc29sdmUocmVzcG9uc2UpKTtcbiAgICAgIGVtaXR0ZXIub24oJ3JlamVjdCcsIGVycm9yID0+IHJlamVjdChlcnJvcikpO1xuICAgIH0pO1xuICB9XG5cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIHRoZSB0b2tlbiBuZWVkcyBhIHJlZnJlc2gsIGlmIG5vdCBlbWl0cyB0aGUgY2FjaGVkIHRva2VuLFxuICAgKiBvdGhlcndpc2UgdHJpZXMgdG8gbG9hZCBhIG5ldyBhY2Nlc3MgdG9rZW5cbiAgICpcbiAgICogQHBhcmFtICB7Q2xpZW50fSBjbGllbnQgdGhlIEFtYWRldXMgQ2xpZW50IHRvIG1ha2UgYW4gQVBJIGNhbGwgd2l0aFxuICAgKiBAcGFyYW0gIHt0eXBlfSBlbWl0dGVyIHRoZSBFdmVudEVtaXR0ZXIgdXNlZCB0byBlbWl0IHRoZSB0b2tlblxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZW1pdE9yTG9hZEFjY2Vzc1Rva2VuKGNsaWVudCwgZW1pdHRlcikge1xuICAgIGlmICh0aGlzLm5lZWRzTG9hZE9yUmVmcmVzaCgpKSB7IHRoaXMubG9hZEFjY2Vzc1Rva2VuKGNsaWVudCwgZW1pdHRlcik7IH1cbiAgICBlbHNlIHsgZW1pdHRlci5lbWl0KCdyZXNvbHZlJywgdGhpcy5hY2Nlc3NUb2tlbik7IH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIHRva2VuIG5lZWRzIGEgcmVmcmVzaCBvciBmaXJzdCBsb2FkXG4gICAqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IHdldGhlciB0aGUgdG9rZW4gbmVlZHMgYSByZWZyZXNoXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBuZWVkc0xvYWRPclJlZnJlc2goKSB7XG4gICAgaWYgKCF0aGlzLmFjY2Vzc1Rva2VuKSB7IHJldHVybiB0cnVlOyB9XG4gICAgZWxzZSBpZiAoKERhdGUubm93KCkgKyBUT0tFTl9CVUZGRVIpID4gdGhpcy5leHBpcmVzQXQpIHsgcmV0dXJuIHRydWU7IH1cbiAgICBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9XG4gIH1cblxuXG4gIC8qKlxuICAgKiBMb2FkcyB0aGUgYWNjZXNzIHRva2VuIHVzaW5nIHRoZSBjbGllbnQsIGVtaXRzIHRoZSB0b2tlbiB3aGVuIGl0J3MgbG9hZGVkXG4gICAqXG4gICAqIEBwYXJhbSAge0NsaWVudH0gY2xpZW50IHRoZSBBbWFkZXVzIENsaWVudCB0byBtYWtlIGFuIEFQSSBjYWxsIHdpdGhcbiAgICogQHBhcmFtICB7dHlwZX0gZW1pdHRlciB0aGUgRXZlbnRFbWl0dGVyIHVzZWQgdG8gZW1pdCB0aGUgdG9rZW5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGxvYWRBY2Nlc3NUb2tlbihjbGllbnQsIGVtaXR0ZXIpIHtcbiAgICBjbGllbnQudW5hdXRoZW50aWNhdGVkUmVxdWVzdCgnUE9TVCcsICcvdjEvc2VjdXJpdHkvb2F1dGgyL3Rva2VuJywge1xuICAgICAgJ2dyYW50X3R5cGUnIDogJ2NsaWVudF9jcmVkZW50aWFscycsXG4gICAgICAnY2xpZW50X2lkJyA6IGNsaWVudC5jbGllbnRJZCxcbiAgICAgICdjbGllbnRfc2VjcmV0JyA6IGNsaWVudC5jbGllbnRTZWNyZXRcbiAgICB9KS50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgdGhpcy5zdG9yZUFjY2Vzc1Rva2VuKHJlc3BvbnNlKTtcbiAgICAgIHRoaXMuZW1pdE9yTG9hZEFjY2Vzc1Rva2VuKGNsaWVudCwgZW1pdHRlcik7XG4gICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBlbWl0dGVyLmVtaXQoJ3JlamVjdCcsIGVycm9yKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9yZXMgYSBsb2FkZWQgYWNjZXNzIHRva2VuLCBjYWxjdWxhdGluZyB0aGUgZXhwaXJ5IGRhdGVcbiAgICpcbiAgICogQHBhcmFtICB7UmVzcG9uc2V9IHJlc3BvbnNlIHRoZSByZXNwb25zZSBvYmplY3QgcmVjZWl2ZWQgZnJvbSB0aGUgY2xpZW50XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzdG9yZUFjY2Vzc1Rva2VuKHJlc3BvbnNlKSB7XG4gICAgdGhpcy5hY2Nlc3NUb2tlbiA9IHJlc3BvbnNlLnJlc3VsdFsnYWNjZXNzX3Rva2VuJ107XG4gICAgdGhpcy5leHBpcmVzQXQgPSBEYXRlLm5vdygpICsgKHJlc3BvbnNlLnJlc3VsdFsnZXhwaXJlc19pbiddICogMTAwMCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQWNjZXNzVG9rZW47XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUFrQyxTQUFBRCx1QkFBQUUsR0FBQSxX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